# Cutie RSA

## Description

> Just gotta follow the path of **greatness!**

- **Points**: 500
- **Given Files:** Output & source code

## Goal of the challenge

A classic RSA challenge made to train mathematical insight.

---

### Output

```markdown
n = 83249929220140554582670885531255565640885159414218783756941730047185184171018543432952637561377734203984883448145323527731279859662427742138403874544977907782880877040617461134969269592331765333416076911615307674994061794824045377291919088849797963976744370433607340620832651512863545791812707240248033331517

ct = 55169419084211094408789720894662403314528583478963737884074781965441540941978004919789540016229194362599564986773561149094215118607278643897876334420436363044041420680603075372064363119303221748729219442080894218732246547437349072762928688876084786617595239661948618350242063871371090539426378445225125582303

HINT = 936622021958062552234083673827789817941093185659377904874515075009592417840858700166824076981616657363026877798417913993248447919193376512006123896475862526143799830483994154378533094796202554641634191900189994942337182800921536876289200625088782168652910354490102485812595971432276804029024266461301777216689152142109720883529818370780025117690462839397684296980122547345374169533368053266103938225964355807873236527095092346278364902561090363680021923517378464
```

### Source Code

```python
from Crypto.Util.number import getPrime, bytes_to_long
from math import gcd

p, q = getPrime(512), getPrime(512)

e = 65537
phi = (p - 1) * (q - 1)
while gcd(e, phi) != 1:
    p, q = getPrime(512), getPrime(512)
    phi = (p - 1) * (q - 1)

d = pow(e, -1, phi)
n = p * q
HINT = phi * p

FLAG = "FL1TZ{??????????????????????}"

m = bytes_to_long(FLAG.encode())
ct = pow(m, e, n)
print(f"{n = }\n\n{ct = }\n\n{HINT = }")
```

---

## Solution Walkthrough

The hint gives us some knowledge about $\phi(n)*p$ which we can use to deduce one of n's factors.

Rearranging the equation gives us 

$$
hint = (p-1)*(q-1)*p \\ hint = qp^2-p^2 -pq+p \\ hint = np-p^2-n+p \\ 
hint = -(p^2-p(n+1)+n)
$$

This is a quadratic equation where the soution is the value of p.

Solving for it gives us *p*, which is enough to factor *n* and deduce *d*, letting us decrypt the cipher.

## Solver

```python
n = 83249929220140554582670885531255565640885159414218783756941730047185184171018543432952637561377734203984883448145323527731279859662427742138403874544977907782880877040617461134969269592331765333416076911615307674994061794824045377291919088849797963976744370433607340620832651512863545791812707240248033331517
ct = 55169419084211094408789720894662403314528583478963737884074781965441540941978004919789540016229194362599564986773561149094215118607278643897876334420436363044041420680603075372064363119303221748729219442080894218732246547437349072762928688876084786617595239661948618350242063871371090539426378445225125582303
HINT = 936622021958062552234083673827789817941093185659377904874515075009592417840858700166824076981616657363026877798417913993248447919193376512006123896475862526143799830483994154378533094796202554641634191900189994942337182800921536876289200625088782168652910354490102485812595971432276804029024266461301777216689152142109720883529818370780025117690462839397684296980122547345374169533368053266103938225964355807873236527095092346278364902561090363680021923517378464

from Crypto.Util.number import long_to_bytes
from sympy import symbols, Eq, solve

e = 65537
x = symbols("x")
a = -1
b = 1 + n
c = -n - HINT

equation = Eq(a * x**2 + b * x + c, 0)

solution = solve(equation)
p1, p2 = solution[0], solution[1]

if p1 < 0:
    p = p2
else:
    p = p1

p = int(p)
q = n // p
phi = (p - 1) * (q - 1)
d = pow(e, -1, phi)

# Decrypt
m = pow(ct, d, n)
flag = long_to_bytes(m).decode()

print(f"Flag: {flag}")
```

## Solution:

Flag: FL1TZ{l1ttl3_1nf0_G035_A_L0nG_W4y}
